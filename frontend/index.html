<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Panel Inspection</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div></div>
  <div class="header-center">
    <h1>PMS Digital Panel Inspection</h1>
  </div>
  <div class="header-right">
    <button class="header-btn" onclick="exportChecklistPDF()">ğŸ“„ Export Checklist (PDF)</button>
  </div>
</div>

<div class="main-container">

  <!-- LEFT PANEL -->
  <div class="left-panel">

    <!-- BOM CARD -->
    <div class="card">
      <div class="card-header">
        <span class="card-icon">ğŸ“‹</span>
        <span class="card-title">BOM Checklist</span>
      </div>

      <div class="card-body">
        <div class="inline-input-row">
          <div class="file-input-wrapper">
            <input type="file" id="bomFile" accept=".pdf">
            <label for="bomFile" class="file-label">Choose File</label>
            <span id="bomFileName" class="file-name">No file chosen</span>
          </div>

          <div class="file-input-wrapper">
            <label class="file-label">Sr.No</label>
            <input type="text" id="bomPanelNo" class="remarks-input"
                   placeholder="Enter BOM Panel Serial No">
          </div>

          <div class="file-input-wrapper">
            <label class="file-label">DD No</label>
            <input type="text" id="ddNo" class="remarks-input"
                   placeholder="Enter DD Number">
          </div>
        </div>

        <button class="btn-primary" onclick="uploadBOM()">
          ğŸ“¤ Upload & Generate Checklist
        </button>
      </div>
    </div>

    <!-- CHECKLIST -->
    <div class="card checklist-card">
      <div class="checklist-header">
        <div class="checklist-stats">
          <span class="stat-ok">âœ“ <span id="okCount">0</span> OK</span>
          <span class="stat-ng">âœ— <span id="ngCount">0</span> NG</span>
          <span class="stat-total">ğŸ“Š <span id="totalCount">0</span> Total</span>
          <span class="divider">|</span>
          <span class="inspector-input-wrapper">
            <label for="inspectorName" class="inspector-label">Inspector:</label>
            <input type="text" id="inspectorName" class="inspector-input" placeholder="Enter name">
          </span>
          <span class="inspector-input-wrapper">
            <label for="inspectorSignature" class="inspector-label">Signature:</label>
            <input type="text" id="inspectorSignature" class="signature-input" placeholder="Sign here">
          </span>
        </div>
      </div>

      <div class="table-container">
        <table class="checklist-table">
          <thead>
            <tr>
              <th>FIND</th>
              <th>PART DESCRIPTION</th>
              <th>STATUS</th>
              <th>REMARKS</th>
              <th>SCAN</th> <!-- âœ… ADD -->
            </tr>
          </thead>
          <tbody id="checklistBody">
            <tr>
              <td colspan="4" class="empty-state">
                ğŸ“‹ Upload BOM to generate checklist
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>

  <!-- RIGHT PANEL -->
  <div class="right-panel">

    <!-- DETAILS -->
    <div class="card details-card">
      <div class="card-header">
        <span class="card-icon">ğŸ‘¤</span>
        <span class="card-title">Selected Component</span>
      </div>
      <div class="details-body">
        <table id="detailsTable">
          <tbody>
            <tr>
              <td colspan="2" class="empty-state">ğŸ‘† Select a component</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- GA VIEWER -->
    <div class="card ga-card">
      <div class="card-header">
        <span class="card-icon">ğŸ”</span>
        <span class="card-title">GA Viewer</span>
      </div>

      <div class="ga-upload-section">
        <div class="inline-input-row">
          <div class="file-input-wrapper">
            <input type="file" id="gaFile" accept=".pdf">
            <label for="gaFile" class="file-label">Choose File</label>
            <span id="gaFileName" class="file-name">No file chosen</span>
          </div>

          <div class="file-input-wrapper">
            <label class="file-label">GA Panel No</label>
            <input type="text" id="gaPanelNo" class="remarks-input"
                   placeholder="Enter GA Panel Serial No">
          </div>
        </div>

        <button class="btn-primary" onclick="uploadGA()">
          ğŸ“¤ Upload & Process GA
        </button>
      </div>

      <div class="ga-controls">
        <button class="ctrl-btn" onclick="prevPage()">â—€ Prev</button>
        <span id="pageInfo" class="page-info">No GA loaded</span>
        <button class="ctrl-btn" onclick="nextPage()">Next â–¶</button>
        <span class="divider">|</span>
        <button class="ctrl-btn" onclick="zoomOut()">ğŸ”âˆ’</button>
        <button class="ctrl-btn" onclick="zoomIn()">ğŸ”+</button>
        <button class="ctrl-btn" onclick="fitToPage()">âŠ¡ Fit</button>
      </div>

      <div id="gaContainer">
        <div id="gaInner">
          <img id="gaImage">
          <div id="highlightLayer"></div>
        </div>
        <div id="gaPlaceholder" class="ga-placeholder">
          ğŸ“„ Upload and process GA to view drawing
        </div>
      </div>
    </div>

  </div>
</div>

<!-- MODAL -->
<div id="progressModal" class="modal">
  <div class="modal-content">
    <h3>âš™ï¸ Processing GA</h3>
    <div class="spinner"></div>
    <div class="progress-bar-container">
      <div id="progressBar" class="progress-bar">0%</div>
    </div>
    <div id="progressMessage" class="progress-message"></div>
    <!-- ADD THIS CANCEL BUTTON -->
    <button class="btn-cancel" onclick="cancelGAProcessing()" style="margin-top: 15px;">
      âœ– Cancel Processing
    </button>
  </div>
</div>

<!-- CAMERA MODAL -->
<div id="cameraModal" class="modal">
  <div class="modal-content" style="width: 520px;">
    <h3>ğŸ“· Scan Component</h3>
    <video id="cameraVideo" autoplay playsinline style="width:100%; border-radius:8px;"></video>
    <canvas id="cameraCanvas" style="display:none;"></canvas>
    <div style="display:flex; gap:10px; justify-content:center; margin-top:15px;">
      <button class="btn-primary" onclick="capturePhoto()">ğŸ“¸ Capture</button>
      <button class="btn-cancel" onclick="closeCamera()">âœ– Close</button>
    </div>
  </div>
</div>


<script src="script.js"></script>
</body>
</html>